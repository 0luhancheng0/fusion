# Representation Fusion for Node Classification and Link Prediction

## Environment Configuration

The [conda environment file](environment.yml) defines an sufficient environment for running the code but a lot packages are not entirely necessary. If you want the bare minimum the following should suffice

```
mamba create -n rapids-24.12 -c rapidsai -c conda-forge -c nvidia -c pytorch -c pyg \
    rapids=24.12 python=3.12 'cuda-version=12.4' \
    jupyterlab networkx nx-cugraph=24.12 dash 'pytorch=2.4.*=*cuda*' xarray-spatial lightning graph-tool sentence-transformers \
    streamlit huggingface_hub pyg pytorch-scatter pytorch-sparse pytorch-cluster
mamba install -c dglteam/label/th24_cu124 dgl
mamba install -c conda-forge typer ogb colorlog tensorboard seaborn datamapplot umap-learn lovely-tensors ipympl tabulate
pip install pyg-lib -f https://data.pyg.org/whl/torch-2.4.0+cu124.html
pip install -U 'jsonargparse[signatures]>=4.27.7'
```





## Fusion

you can run `python fusion.py --help` to get a list of options. 

```
 Usage: fusion.py [OPTIONS] COMMAND [ARGS]...

╭─ Options ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ --install-completion          Install completion for the current shell.                                                             │
│ --show-completion             Show completion for the current shell, to copy it or customize the installation.                      │
│ --help                        Show this message and exit.                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─ Commands ──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ early-fusion                                                                                                                        │
│ addition-fusion                                                                                                                     │
│ gated-fusion                                                                                                                        │
│ lowrank-fusion                                                                                                                      │
│ transformer-fusion                                                                                                                  │
│ transformer-exp                                                                                                                     │
│ early-exp                                                                                                                           │
│ addition-exp                                                                                                                        │
│ gated-exp                                                                                                                           │
│ lowrank-exp                                                                                                                         │
│ check-results        Check how many trials of fusion experiments have been run.                                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯

```

The full slurm script i used for generating the results from the paper is available at `sbatchme.sh`

The resulting figure can be generated by running `python analysis/crossmodel.py` or use the [notebook](notebook.ipynb)